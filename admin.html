
<!doctype html><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Ironwood Admin</title>

<style>
:root{--bg:#0b0e11;--surface:#12161a;--muted:#8c98a4;--text:#eef2f6;--brand:#dc2626;--accent:#fca5a5}
*{box-sizing:border-box}html,body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
a{color:inherit;text-decoration:none}img{max-width:100%;display:block;border-radius:12px}
.container{width:min(1200px,92vw);margin-inline:auto}.muted{color:#9aa7b3}
.btn{display:inline-flex;gap:.6rem;align-items:center;background:var(--brand);color:#fff;padding:.7rem 1rem;border-radius:999px;font-weight:700;border:2px solid transparent}
.btn.secondary{background:transparent;border-color:#2b333b}
.card{background:#12161a;border:1px solid #1a2128;border-radius:18px;padding:1rem}
header.topbar{position:sticky;top:0;background:rgba(11,14,17,.8);backdrop-filter:saturate(1.1) blur(8px);border-bottom:1px solid #1a2128;z-index:20}
header .wrap{display:flex;align-items:center;justify-content:space-between;padding:.6rem 0;gap:.6rem;flex-wrap:wrap}
.brand{display:flex;gap:.6rem;align-items:center;font-weight:900}.brand img{height:44px}
nav{display:flex;gap:.4rem;flex-wrap:wrap}.pill{padding:.45rem .7rem;border-radius:10px}nav a:hover{background:#1a2128}
@media (max-width:640px){header .wrap{flex-direction:column;align-items:flex-start}.brand img{height:36px}nav{width:100%;display:grid;grid-template-columns:1fr 1fr;gap:.4rem}nav .btn{grid-column:1/-1;justify-content:center}}
footer{background:#0a0d10;border-top:1px solid #182028;padding:36px 0 80px;margin-top:40px}
</style>

<header class="topbar"><div class="container wrap"><a class="brand" href="index.html"><img id="adminHomeLogo" src="assets/logo-ld-original.png"><span>Back to Ironwood site</span></a></div></header>
<div class="container" style="padding:24px 0 60px">
  <div class="card"><h2>Connection</h2>
    <div style="display:flex;gap:10px;flex-wrap:wrap"><input id="gh_owner" placeholder="GitHub owner"><input id="gh_repo" placeholder="Repo (ironwood-content)"><input id="gh_branch" value="main" placeholder="Branch (main)"></div>
    <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:8px"><input id="gh_token" type="password" placeholder="Personal Access Token (contents: read/write)"><button id="saveCreds" class="btn">Save</button></div>
    <small class="muted">Saved in your browser only (localStorage). This page writes directly to your GitHub repo.</small>
  </div>

  <div class="card"><h2>Branding & Colors</h2>
    <div style="display:flex;gap:10px;flex-wrap:wrap"><label>Site Logo URL<input id="logo_site"></label><label>Dumpsters Logo URL<input id="logo_dump"></label></div>
    <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:8px"><label>Brand<input id="c_brand" type="color" value="#dc2626"></label><label>Accent<input id="c_accent" type="color" value="#fca5a5"></label><label>Background<input id="c_bg" type="color" value="#0b0e11"></label><label>Surface<input id="c_surface" type="color" value="#12161a"></label><label>Text<input id="c_text" type="color" value="#eef2f6"></label><label>Muted<input id="c_muted" type="color" value="#8c98a4"></label></div>
    <div style="display:flex;gap:10px;align-items:center;margin-top:8px"><button id="saveTheme" class="btn">Save Branding</button><span id="msgTheme" class="muted"></span></div>
  </div>

  <div class="card"><h2>Site Settings</h2>
    <div style="display:flex;gap:10px;flex-wrap:wrap"><label>Business<input id="name"></label><label>Phone (display)<input id="phone"></label><label>Phone (raw +1318...)<input id="phone_raw"></label></div>
    <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:8px"><label>Address (HTML)<textarea id="address" rows="2"></textarea></label><label>Address (text for map)<input id="address_text" placeholder="805 E. Main St, Oak Grove, LA 71263"></label></div>
    <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:8px"><label>Hours<input id="hours"></label><label>Contact Email<input id="contact_email" type="email"></label></div>
    <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:8px"><label>Hero Eyebrow<input id="eyebrow"></label><label>Hero Headline<input id="headline"></label></div>
    <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:8px"><label>Hero Sub<textarea id="sub" rows="2"></textarea></label><label>Hero Background URL<input id="hero_image"></label></div>
    <div style="margin-top:8px"><label>Services (one per line)<textarea id="services" rows="5" style="width:100%"></textarea></label></div>
    <h3>Dumpsters</h3>
    <div style="display:flex;gap:10px;flex-wrap:wrap"><label>Company<input id="dump_company"></label><label>Small Weekly ($)<input id="rate_small" type="number"></label><label>Large Weekly ($)<input id="rate_large" type="number"></label><label>Area<input id="area"></label></div>
    <div style="display:flex;gap:10px;align-items:center;margin-top:8px"><button id="saveCfg" class="btn">Save Settings</button><span id="msg" class="muted"></span></div>
  </div>

  <div class="card"><h2>Jobs Manager</h2>
    <div style="display:flex;gap:10px;flex-wrap:wrap"><label>Title<input id="job_title"></label><label>Location<input id="job_location"></label><label>Date<input id="job_date" type="date"></label></div>
    <div style="margin-top:8px"><label>Description<textarea id="job_desc" rows="3" style="width:100%"></textarea></label></div>
    <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:8px"><label>Before photos<input id="job_before" type="file" accept="image/*" multiple></label><label>After photos<input id="job_after" type="file" accept="image/*" multiple></label></div>
    <div style="display:flex;gap:10px;align-items:center;margin-top:8px"><button id="job_create" class="btn">Create Job</button><span id="job_msg" class="muted"></span></div>
    <h3 style="margin-top:12px">Existing Jobs</h3><div id="jobs_list" style="display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))"></div>
  </div>

  <div class="card"><h2>Dumpster Photos</h2>
    <div style="display:flex;gap:10px;flex-wrap:wrap"><input id="dump_files" type="file" accept="image/*" multiple><button id="dump_upload" class="btn">Upload Dumpster Photos</button></div>
    <div id="dump_log" class="muted" style="margin-top:6px"></div><h3 style="margin-top:10px">Current Dumpster Photos</h3><div id="dump_grid" style="display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(180px,1fr))"></div>
  </div>

  <div class="card"><h2>Version & Deploy Status</h2>
    <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:flex-end">
      <label>GitHub Owner<input id="ver_owner" placeholder="your-username"></label>
      <label>Repo<input id="ver_repo" placeholder="ironwood-content"></label>
      <label>Branch<input id="ver_branch" placeholder="main" value="main"></label>
      <button id="ver_refresh" class="btn">Refresh Status</button>
      <button id="ver_write" class="btn secondary">Write version.json now</button>
    </div>
    <div id="ver_status" style="margin-top:10px;font-family:ui-monospace,Consolas,monospace;background:#0f1419;border:1px solid #24303b;padding:10px;border-radius:10px;white-space:pre-wrap"></div>
    <div id="ver_buildline" style="margin-top:8px;font-family:ui-monospace,Consolas,monospace;"></div>
  </div>
</div>
<script>
const els={owner:gh_owner,repo:gh_repo,branch:gh_branch,token:gh_token,saveCreds,logo_site,logo_dump,c_brand,c_accent,c_bg,c_surface,c_text,c_muted,saveTheme,msgTheme,name,phone,phone_raw,address,address_text,hours,contact_email,eyebrow,headline,sub,hero_image,services,dump_company,rate_small,rate_large,area,saveCfg,msg,job_title,job_location,job_date,job_desc,job_before,job_after,job_create,job_msg,jobs_list,dump_files,dump_upload,dump_grid,dump_log};
saveCreds.onclick=function(){ localStorage.setItem('ironwood_gh',JSON.stringify({owner:els.owner.value,repo:els.repo.value,branch:els.branch.value||'main'})); localStorage.setItem('ironwood_gh_token',els.token.value); alert('Saved!'); };
(function(){ const gh=JSON.parse(localStorage.getItem('ironwood_gh')||'{}'); els.owner.value=gh.owner||''; els.repo.value=gh.repo||'ironwood-content'; els.branch.value=gh.branch||'main'; els.token.value=localStorage.getItem('ironwood_gh_token')||''; })();
const GH=()=>({owner:els.owner.value,repo:els.repo.value,branch:els.branch.value||'main',token:els.token.value});
const RAW=(p)=>'https://raw.githubusercontent.com/'+GH().owner+'/'+GH().repo+'/'+GH().branch+'/'+p;
let __lastCommitSha='';
async function ghGet(p){ const h={}; if(GH().token) h['Authorization']='Bearer '+GH().token; const r=await fetch('https://api.github.com/repos/'+GH().owner+'/'+GH().repo+'/contents/'+p+'?ref='+GH().branch,{headers:h}); if(!r.ok) return null; return await r.json(); }
async function ghPutText(p,t,m){ const ex=await ghGet(p); const body={message:m||('update '+p),content:btoa(unescape(encodeURIComponent(t))),branch:GH().branch}; if(ex&&ex.sha) body.sha=ex.sha; const r=await fetch('https://api.github.com/repos/'+GH().owner+'/'+GH().repo+'/contents/'+p,{method:'PUT',headers:{'Authorization':'Bearer '+GH().token,'Content-Type':'application/json'},body:JSON.stringify(body)}); if(!r.ok) throw new Error(await r.text()); const d=await r.json(); __lastCommitSha=(d&&d.commit&&d.commit.sha)?d.commit.sha:(__lastCommitSha||''); return d; }
async function ghPutBinary(p,b64,m){ const ex=await ghGet(p); const body={message:m||('add '+p),content:b64,branch:GH().branch}; if(ex&&ex.sha) body.sha=ex.sha; const r=await fetch('https://api.github.com/repos/'+GH().owner+'/'+GH().repo+'/contents/'+p,{method:'PUT',headers:{'Authorization':'Bearer '+GH().token,'Content-Type':'application/json'},body:JSON.stringify(body)}); if(!r.ok) throw new Error(await r.text()); const d=await r.json(); __lastCommitSha=(d&&d.commit&&d.commit.sha)?d.commit.sha:(__lastCommitSha||''); return d; }
async function ghList(path){ const h={}; if(GH().token) h['Authorization']='Bearer '+GH().token; const r=await fetch('https://api.github.com/repos/'+GH().owner+'/'+GH().repo+'/contents/'+path+'?ref='+GH().branch,{headers:h}); if(!r.ok) return null; return await r.json(); }
async function ghDel(path,msg){ const h={}; if(GH().token) h['Authorization']='Bearer '+GH().token; const meta=await ghGet(path); if(!meta||!meta.sha) throw new Error('Cannot fetch SHA for '+path); const r=await fetch('https://api.github.com/repos/'+GH().owner+'/'+GH().repo+'/contents/'+path,{method:'DELETE',headers:{...h,'Content-Type':'application/json'},body:JSON.stringify({message:msg||('delete '+path),sha:meta.sha,branch:GH().branch})}); if(!r.ok) throw new Error(await r.text()); return await r.json(); }
async function loadCfgLocal(){ try{ const r=await fetch('config.json?_='+Date.now()); if(r.ok) return r.json(); }catch(e){} return null; }
async function loadCfgRaw(){ try{ const r=await fetch(RAW('config.json')+'?_='+Date.now()); if(r.ok) return r.json(); }catch(e){} return null; }
async function fillForm(){ const c=await(loadCfgLocal()||loadCfgRaw()||Promise.resolve(null)); if(!c) return; if(c.logos?.site) adminHomeLogo.src=c.logos.site; if(c.logos){ if(c.logos.site) logo_site.value=c.logos.site; if(c.logos.dumpsters) logo_dump.value=c.logos.dumpsters; } if(c.theme){ c_brand.value=c.theme.brand||c_brand.value; c_accent.value=c.theme.accent||c_accent.value; c_bg.value=c.theme.bg||c_bg.value; c_surface.value=c.theme.surface||c_surface.value; c_text.value=c.theme.text||c_text.value; c_muted.value=c.theme.muted||c_muted.value; } name.value=c.business?.name||''; phone.value=c.business?.phone||''; phone_raw.value=c.business?.phone_raw||''; address.value=c.business?.address_html||''; address_text.value=c.business?.address_text||''; hours.value=c.business?.hours||''; contact_email.value=c.contact_email||''; eyebrow.value=c.hero?.eyebrow||''; headline.value=c.hero?.headline||''; sub.value=c.hero?.sub||''; hero_image.value=c.hero?.image||''; services.value=(c.services||[]).join('\n'); dump_company.value=c.dumpsters?.company||''; rate_small.value=c.dumpsters?.weekly_small||''; rate_large.value=c.dumpsters?.weekly_large||''; area.value=c.dumpsters?.area||''; await renderJobsList(); await renderDumpGrid(); }
saveTheme.onclick=async()=>{ const local=await loadCfgLocal(); const c=local||{}; c.theme={brand:c_brand.value,accent:c_accent.value,bg:c_bg.value,surface:c_surface.value,text:c_text.value,muted:c_muted.value}; c.logos=c.logos||{}; if(logo_site.value) c.logos.site=logo_site.value; if(logo_dump.value) c.logos.dumpsters=logo_dump.value; msgTheme.textContent='Saving...'; try{ await ghPutText('config.json',JSON.stringify(c,null,2),'update branding'); await writeVersionJson('config updated'); msgTheme.textContent='Saved!'; }catch(e){ msgTheme.textContent='Error: '+e.message; } };
saveCfg.onclick=async()=>{ const local=await loadCfgLocal(); const cfg=local||{}; cfg.business={name:name.value,phone:phone.value,phone_raw:phone_raw.value,address_html:address.value||'805 E. Main St<br>Oak Grove, LA 71263',address_text:address_text.value||'805 E. Main St, Oak Grove, LA 71263',hours:hours.value||'Mon–Sat 7a–6p'}; cfg.contact_email=contact_email.value.trim(); cfg.hero={eyebrow:eyebrow.value,headline:headline.value,sub:sub.value,image:hero_image.value}; cfg.services=services.value.split('\n').map(s=>s.trim()).filter(Boolean); cfg.dumpsters={company:dump_company.value,weekly_small:Number(rate_small.value||0),weekly_large:Number(rate_large.value||0),area:area.value,includes_dump_fee:true}; msg.textContent='Saving...'; try{ await ghPutText('config.json',JSON.stringify(cfg,null,2),'update config'); await writeVersionJson('config updated'); msg.textContent='Saved!'; }catch(e){ msg.textContent='Error: '+e.message; } };
async function listJobsLocal(){ try{ const r=await fetch('jobs/index.json?_='+Date.now()); if(r.ok) return r.json(); }catch(e){} return []; }
async function listJobsRaw(){ try{ const r=await fetch(RAW('jobs/index.json')+'?_='+Date.now()); if(r.ok) return r.json(); }catch(e){} return []; }
async function renderJobsList(){ let jobs=await listJobsLocal(); if(!jobs.length) jobs=await listJobsRaw(); jobs_list.innerHTML=(jobs&&jobs.length)?jobs.map(j=>"<div class='card'><strong>"+(j.title||'Job')+"</strong><br><small class='muted'>"+(j.location||'')+"</small><div style='display:flex;gap:8px;margin-top:8px'><button onclick="editJob('"+j.id+"')" class='btn'>Edit</button><button onclick="deleteJob('"+j.id+"')" class='btn secondary'>Delete</button><a class='btn secondary' href='jobs.html?id="+encodeURIComponent(j.id)+"' target='_blank'>View</a></div></div>").join(''):'<div class="card"><small>No jobs yet.</small></div>'; }
async function toB64(file){ return await new Promise((res,rej)=>{ const fr=new FileReader(); fr.onerror=()=>rej('read error'); fr.onload=()=>res(String(fr.result).split(',')[1]||''); fr.readAsDataURL(file); }); }
async function createJobFolder(id){ await ghPutText('jobs/'+id+'/.keep','keep','create job folder'); }
job_create.onclick=async()=>{ if(!GH().token){ job_msg.textContent='Enter and Save your GitHub token first.'; return; } const title=job_title.value.trim(); if(!title){ job_msg.textContent='Title required'; return; } const id=Date.now()+'-'+title.toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/^-+|-+$/g,''); job_msg.textContent='Uploading...'; try{ const before=Array.from(job_before.files||[]); const after=Array.from(job_after.files||[]); let meta={id,title,location:job_location.value,date:job_date.value,description:job_desc.value,before:[],after:[]}; await createJobFolder(id); for(const f of before){ const b64=await toB64(f); const safe=(f.name||'before.jpg').toLowerCase().replace(/[^a-z0-9._-]+/g,'-'); const path='jobs/'+id+'/before-'+Date.now()+'-'+safe; await ghPutBinary(path,b64,'add before'); meta.before.push(RAW(path)); } for(const f of after){ const b64=await toB64(f); const safe=(f.name||'after.jpg').toLowerCase().replace(/[^a-z0-9._-]+/g,'-'); const path='jobs/'+id+'/after-'+Date.now()+'-'+safe; await ghPutBinary(path,b64,'add after'); meta.after.push(RAW(path)); } await ghPutText('jobs/'+id+'/meta.json',JSON.stringify(meta,null,2),'add meta'); let index=await listJobsLocal(); if(!index.length) index=await listJobsRaw(); index=Array.isArray(index)?index:[]; index.unshift({id,title:meta.title,location:meta.location,date:meta.date,cover_after:meta.after[0]||'',cover:meta.before[0]||'',summary:meta.description||''}); await ghPutText('jobs/index.json',JSON.stringify(index,null,2),'update jobs index'); await writeVersionJson('job created'); job_msg.textContent='Job saved!'; job_title.value=job_location.value=job_date.value=job_desc.value=''; job_before.value=job_after.value=''; await renderJobsList(); }catch(e){ job_msg.textContent='Error: '+e.message; } };
async function editJob(id){ let meta=null; try{ let r=await fetch('jobs/'+id+'/meta.json?_='+Date.now()); if(r.ok) meta=await r.json(); }catch(e){} if(!meta){ const r=await fetch(RAW('jobs/'+id+'/meta.json')+'?_='+Date.now()); if(!r.ok){ alert('Could not load job meta'); return; } meta=await r.json(); } const newTitle=prompt('Title',meta.title||''); if(newTitle===null) return; const newLoc=prompt('Location',meta.location||''); if(newLoc===null) return; const newDate=prompt('Date (YYYY-MM-DD)',meta.date||''); if(newDate===null) return; const newDesc=prompt('Description',meta.description||meta.summary||''); if(newDesc===null) return; meta.title=newTitle; meta.location=newLoc; meta.date=newDate; meta.description=newDesc; try{ await ghPutText('jobs/'+id+'/meta.json',JSON.stringify(meta,null,2),'edit job meta'); let index=await listJobsLocal(); if(!index.length) index=await listJobsRaw(); index=index.map(j=>j.id===id?Object.assign(j,{title:newTitle,location:newLoc,date:newDate,summary:newDesc}):j); await ghPutText('jobs/index.json',JSON.stringify(index,null,2),'edit job index'); await writeVersionJson('job edited'); alert('Saved.'); await renderJobsList(); }catch(e){ alert('Error: '+e.message); } }
async function deleteJob(id){ if(!confirm('Delete this job? This cannot be undone.')) return; try{ const files=await ghList('jobs/'+id)||[]; for(const f of files){ await ghDel('jobs/'+id+'/'+f.name,'delete job asset'); } let index=await listJobsLocal(); if(!index.length) index=await listJobsRaw(); index=index.filter(j=>j.id!==id); await ghPutText('jobs/index.json',JSON.stringify(index,null,2),'remove job from index'); await writeVersionJson('job deleted'); await renderJobsList(); }catch(e){ alert('Error: '+e.message); } }
async function listDumpLocal(){ try{ const r=await fetch('dumpsters/photos/index.json?_='+Date.now()); if(r.ok) return r.json(); }catch(e){} return []; }
async function listDumpRaw(){ try{ const r=await fetch(RAW('dumpsters/photos/index.json')+'?_='+Date.now()); if(r.ok) return r.json(); }catch(e){} return []; }
async function renderDumpGrid(){ let list=await listDumpLocal(); if(!list.length) list=list=await listDumpRaw(); dump_grid.innerHTML=list.length?list.map(u=>"<img src='"+u+"' alt='dumpster'>").join(''):'<p class='muted'>No dumpster photos yet.</p>"; }
dump_upload.onclick=async()=>{ const f=dump_files.files; if(!f.length){ dump_log.textContent='Pick dumpster image(s)'; return; } if(!GH().token){ dump_log.textContent='Enter and Save your GitHub token first.'; return; } dump_log.textContent='Uploading...'; try{ let list=await listDumpLocal(); if(!list.length) list=await listDumpRaw(); async function toB64(file){ return await new Promise((res,rej)=>{ const fr=new FileReader(); fr.onerror=()=>rej('read error'); fr.onload=()=>res(String(fr.result).split(',')[1]||''); fr.readAsDataURL(file); }); } for(const file of f){ const b64=await toB64(file); const safe=(file.name||'dumpster.jpg').toLowerCase().replace(/[^a-z0-9._-]+/g,'-'); const key='dumpsters/photos/'+Date.now()+'-'+safe; await ghPutBinary(key,b64,'add dumpster photo'); list.unshift(RAW(key)); } await ghPutText('dumpsters/photos/index.json',JSON.stringify(list,null,2),'update dumpster photo index'); await writeVersionJson('dumpster photos'); dump_log.textContent='Done.'; await renderDumpGrid(); }catch(e){ dump_log.textContent='Error: '+e.message; } };
async function ghLatestCommitSha(owner,repo,branch){ const r=await fetch('https://api.github.com/repos/'+owner+'/commits/'+encodeURIComponent(branch),{headers:GH().token?{'Authorization':'Bearer '+GH().token}:{}}); if(!r.ok) throw new Error(await r.text()); const d=await r.json(); return d&&d.sha?d.sha:''; }
async function readVersionJsonFromSite(){ try{ const r=await fetch('version.json?_='+Date.now()); if(!r.ok) return null; return await r.json(); }catch(e){ return null; } }
async function writeVersionJson(note){ const owner=els.owner.value||ver_owner.value; const repo=els.repo.value||ver_repo.value; const branch=els.branch.value||ver_branch.value||'main'; if(!owner||!repo) throw new Error('Missing owner/repo'); const sha=__lastCommitSha||await ghLatestCommitSha(owner,repo,branch); const payload={ name:'ironwood-site', updated_at:new Date().toISOString(), branch, last_commit_sha:sha, note:note||'admin update' }; await ghPutText('version.json', JSON.stringify(payload,null,2), 'update version.json'); return payload; }
async function refreshVersionStatus(){ const owner=ver_owner.value||els.owner.value; const repo=ver_repo.value||els.repo.value; const branch=ver_branch.value||els.branch.value||'main'; const el=ver_status; try{ const ghSha=await ghLatestCommitSha(owner,repo,branch); const siteV=await readVersionJsonFromSite(); const siteSha=siteV&&siteV.last_commit_sha?siteV.last_commit_sha:'(none)'; const inSync=(ghSha&&siteSha&&ghSha.substring(0,7)===siteSha.substring(0,7)); el.textContent = 'GitHub:  '+owner+'/'+repo+'@'+branch+'\n'+'SHA:     '+ghSha+'\n\n'+'Cloudflare (served file):\n'+'SHA:     '+siteSha+'\n'+'Updated: '+(siteV&&siteV.updated_at?siteV.updated_at:'(unknown)')+'\n'+'Note:    '+(siteV&&siteV.note?siteV.note:'')+'\n\n'+'Status:  '+(inSync?'✅ In Sync':'⚠️ Not in sync yet (wait for deploy or purge cache)'); ver_buildline.style.color=inSync?'#10b981':'#fbbf24'; ver_buildline.textContent='Build:  '+(siteSha&&siteSha.substring(0,7)||'(none)')+' — updated '+(siteV&&siteV.updated_at?new Date(siteV.updated_at).toLocaleString():'(unknown)'); }catch(e){ el.textContent='Error: '+e.message; } }
(function(){ const gh=JSON.parse(localStorage.getItem('ironwood_gh')||'{}'); ver_owner.value=gh.owner||''; ver_repo.value=gh.repo||'ironwood-content'; ver_branch.value=gh.branch||'main'; ver_refresh.onclick=refreshVersionStatus; ver_write.onclick=async function(){ ver_status.textContent='Writing version.json…'; try{ const v=await writeVersionJson('manual write'); ver_status.textContent='Wrote version.json:\n'+JSON.stringify(v,null,2)+'\n\nRun "Refresh Status" after Cloudflare deploy finishes.'; ver_buildline.style.color='#fbbf24'; ver_buildline.textContent='Build:  '+(v.last_commit_sha? v.last_commit_sha.substring(0,7):'(none)')+' — updated '+(new Date(v.updated_at).toLocaleString()); }catch(e){ ver_status.textContent='Error: '+e.message; } }; })();
(async function(){ await renderJobsList(); await renderDumpGrid(); await fillForm(); })();
</script>
